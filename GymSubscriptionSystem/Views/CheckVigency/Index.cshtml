@{
    ViewData["title"] = "CheckVigency";
}

<h1>Welcome</h1>

<div>Scan your QR Id</div>

@if(TempData["Success"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        @TempData["Success"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        @TempData["Error"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<div id="reader" style="width: 300px;"></div>

<div id="resultado" style="margin-top: 20px;">
    <strong>Código escaneado:</strong> <span id="codigoEscaneado"></span>
</div>

<!-- Script de html5-qrcode -->
<script src="https://unpkg.com/html5-qrcode"></script>
<script>
    const qr = new Html5Qrcode("reader");

    qr.start(
        { facingMode: "environment" }, // Usa la cámara trasera del teléfono
        { fps: 10, qrbox: 250 },
        qrCodeMessage => {
            console.log("Código leído:", qrCodeMessage);
            document.getElementById("codigoEscaneado").textContent = qrCodeMessage;
            qr.stop(); // detener después de una lectura
        },
        errorMessage => {
            // Errores al escanear (puedes omitir este callback si no quieres verlos)
        }
    );
</script>